@model AdminLanguageSelectorModel
@using AtiehJobCore.Core.Contracts
@using AtiehJobCore.Core.Infrastructure
@{
    var webHelper = EngineContext.Current.Resolve<IWebHelper>();
}
@*@if (Model.AvailableLanguages.Count > 1)
{

    <li class="dropdown dropdown-extended dropdown-notification">
        <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
            <i class="fa fa-language"></i><span class="username username-hide-on-mobile">
                @Model.AvailableLanguages.FirstOrDefault(x => x.Id == Model.CurrentLanguage.Id)?.UniqueSeoCode
            </span>
        </a>
        <ul class="dropdown-menu dropdown-menu-default">
            @foreach (var lang in Model.AvailableLanguages)
            {
                <li>
                    <a href="@webHelper.ModifyQueryString(Url.Action("SetLanguage", "Home",
                                 new { langid = lang.Id , area = "Admin"}),
                                 "returnurl=" + System.Net.WebUtility.UrlEncode(
                                     webHelper.GetRawUrl(HttpContextAccessor.HttpContext.Request)), null)">
                        <img src="/img/flags/@(lang.FlagImageFileName)" alt="@lang.Name">
                        @lang.Name
                    </a>
                </li>
            }
        </ul>
    </li>
}*@









@if (Model.AvailableLanguages.Count > 1)
{
    var rawUrl = webHelper.GetRawUrl(HttpContextAccessor.HttpContext.Request);

    //var availableLanguage = Model.AvailableLanguages.FirstOrDefault(x => x.Id == Model.CurrentLanguage.Id)?.UniqueSeoCode;

    //var languages = Model.AvailableLanguages.Select(lang => new SelectListItem
    //{
    //    Text = lang.Name,
    //    Value = webHelper.ModifyQueryString(Url.RouteUrl("ChangeLanguage",
    //        new { langId = lang.Id }), "returnurl=" + WebUtility.UrlEncode(rawUrl), null),
    //    Selected = lang.Id.Equals(Model.CurrentLanguage.Id)
    //});

        <div>
            <div class="navbar-nav">
                <div class="dropdown">
                    <a class="nav-item nav-link dropdown-toggle" data-toggle="dropdown"
                       id="userDropdown" aria-haspopup="true"
                       aria-expanded="false" href="#">
                        <img class="img-thumbnail userImage" src="" alt="" asp-append-version="true"
                             onerror="this.style.visibility = 'hidden';this.width=0; this.height=0;" />
                        <span class="author">زبان سیستم</span>
                    </a>

                    <div class="dropdown-menu" aria-labelledby="userDropdown">

                        @foreach (var lang in Model.AvailableLanguages)
                        {
                
                            <a href="@webHelper.ModifyQueryString(Url.Action("SetLanguage", "Home",
                                         new { langid = lang.Id , area = "Admin"}),
                                         "returnurl=" + System.Net.WebUtility.UrlEncode(
                                             webHelper.GetRawUrl(HttpContextAccessor.HttpContext.Request)), null)">
                                <img src="/img/flags/@(lang.FlagImageFileName)" alt="@lang.Name">
                                @lang.Name
                            </a>
                           
                        }
                        <div class="dropdown-divider"></div>
                    </div>
                </div>
            </div>
        </div>


}
